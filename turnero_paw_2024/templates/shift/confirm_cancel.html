{% extends 'base.html' %}
{% load static %}
{% block title %}Detalles del Turno{% endblock title %}
{% block links %}
<link rel="preload" href="{% static 'css/reset.css' %}" 
            as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="{% static 'css/base.css' %}" 
            as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="{% static 'css/header.css' %}" 
            as="style" onload="this.onload=null;this.rel='stylesheet'">  
<link rel="preload" href="{% static 'css/shift/confirm_cancel.css' %}" 
            as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="{% static 'css/shift/modals.css' %}" 
            as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="{% static 'css/footer.css' %}" 
            as="style" onload="this.onload=null;this.rel='stylesheet'">
{% endblock links %}
{% block content %}
    {% include 'includes/header.html' %}
    
        {% if success_message %}
            <h2>Cancelación de turno exitosa</h2>
            <section class="succes-message-container">
                <form id="cancel-shift-form-description" method="post">
                    {% csrf_token %}
                    <h3 class="succes-message">{{ success_message }}</h3>
                    {% if not set_description %}
                        <p class="succes-message__subtitle"> Si desea agregar una descripción del porque de su cancelación al turno, 
                            por favor ingreselá a continuación
                        </p>
                        <textarea 
                            id="cancel-description" 
                            rows="4" 
                            cols="50" 
                            placeholder="Agrega una descripción..." 
                            name="cancel_description" required ></textarea>
                        <span id="char-count"><strong>200</strong> caracteres restantes</span>
                        <button type="submit">Guardar</button>
                    {% endif %}
                </form>
                    <p class="succes-message-container__footer" >
                        En caso de necesitar un nuevo turno presione
                        <a href="/shift/home/" aria-label="home">aquí</a>
                    </p> 
            </section>
            
        {% else %}
            <h2>Confirmar Cancelación de Turno</h2>
            <h3 class="cancel-confirm-container__subtitle">
                Se ha enviado un código de verificación de 6 dígitos a su correo electrónico. 
                Por favor, revísalo y escríbelo a continuación para confirmar la cancelación de su turno.
            </h3>

            <form id="cancel-shift-form" method="post">
                {% csrf_token %}
                <p>
                    <strong>
                        Día:
                    </strong> 
                    {{ shift.date }}
                </p>
                <p>
                    <strong>
                        Horario:
                    </strong> 
                    {{ shift.hour }}
                </p>
                <label for="verification_code">Código de Verificación:</label>
                <input type="text" name="verification_code" required>
                <button type="submit">Cancelar Turno</button>
                {% if error %}
                    <p class="error-message">{{ error }}</p>
                {% endif %}
            </form>
        {% endif %}
    
    {% include 'includes/footer.html' %}
    <script src="{% static 'js/shift/confirm_cancel_modal.js' %}" defer></script>
    <script type="module" src="{% static 'js/includes/footer.js' %}" ></script>
{% endblock %}
